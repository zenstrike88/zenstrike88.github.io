

#<script type="text/javascript" src="https://js-cdn.dynatrace.com/jstag/16a48f5d352/bf25108lzj/eb8e96bcb95f32a3_complete.js" crossorigin="anonymous"></script>




<!DOCTYPE html>
<html lang="fr">
<head>
    <script type="text/javascript" src="https://js-cdn.dynatrace.com/jstag/16a48f5d352/bf25108lzj/eb8e96bcb95f32a3_complete.js" crossorigin="anonymous"></script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zen Strike | Geo-Observability Extreme</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        :root {
            --bg-dark: #0f172a; --panel-bg: #1e293b; --accent: #6366f1;
            --danger: #ef4444; --warning: #f59e0b; --success: #10b981;
            --text-main: #f8fafc; --text-muted: #94a3b8;
        }

        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg-dark); color: var(--text-main); display: flex; flex-direction: column; height: 100vh; }
        header { padding: 1rem 2rem; background: var(--panel-bg); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.5); z-index: 1000; }
        #main-container { display: flex; flex: 1; overflow: hidden; }
        #sidebar { width: 360px; padding: 1.5rem; background: var(--panel-bg); border-right: 1px solid #334155; overflow-y: auto; }
        .section-title { color: var(--accent); text-transform: uppercase; font-size: 0.75rem; font-weight: bold; margin: 1.5rem 0 1rem; display: block; border-bottom: 1px solid #334155; padding-bottom: 5px; }
        #map { flex: 1; background: #111; }
        select { width: 100%; padding: 12px; border-radius: 8px; background: #334155; color: white; border: 1px solid #475569; margin-bottom: 15px; outline: none; }
        
        .btn { width: 100%; padding: 10px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.85rem; }
        .btn-error { background: var(--danger); color: white; }
        .btn-warn { background: var(--warning); color: #0f172a; }
        .btn-info { background: #38bdf8; color: #0f172a; }

        .stat-card { background: var(--bg-dark); padding: 1.2rem; border-radius: 12px; margin-top: 1rem; border: 1px solid #334155; }
        .status-online { color: var(--success); font-size: 0.75rem; font-weight: bold; background: rgba(16, 185, 129, 0.1); padding: 5px 12px; border-radius: 20px; }
    </style>
</head>
<body>

<header>
    <h1>ZEN STRIKE <span style="font-weight: 300; color: var(--accent);">EXTREME</span></h1>
    <span class="status-online">‚óè DYNATRACE ADVANCED MONITORING</span>
</header>

<div id="main-container">
    <div id="sidebar">
        
        <span class="section-title">Navigation</span>
        <select id="countrySelect">
            <option value="">-- Choisir un pays --</option>
            <option value="Algeria">Alg√©rie</option>
            <option value="France">France</option>
            <option value="Japan">Japon</option>
        </select>

        <span class="section-title">Challenge 1: Error Rates</span>
        <button onclick="triggerJSException()" class="btn btn-error">üî• Crash JS Thread</button>
        <button onclick="trigger404()" class="btn btn-error" style="opacity: 0.8;">üö´ Broken Asset (404)</button>

        <span class="section-title">Challenge 2: Performance (Apdex)</span>
        <button onclick="triggerCPUStress()" class="btn btn-warn">üß† Freeze CPU (3s)</button>
        <button onclick="triggerZombieAPI()" class="btn btn-warn">üßü Zombie XHR (Timeout)</button>

        <span class="section-title">Challenge 3: Payload & Metrics</span>
        <button onclick="triggerMassivePayload()" class="btn btn-info">üì¶ Heavy Image Load</button>

        <div id="details" class="stat-card">
            <small style="color: var(--text-muted)">CONSOLE LOG / STATUS</small><br>
            <span id="xhr-status" style="font-size: 0.9rem; color: var(--text-muted);">Pr√™t pour le test...</span>
        </div>
    </div>

    <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    // Carte Dark Mode
    var map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { attribution: '&copy; CARTO' }).addTo(map);

    const statusLabel = document.getElementById('xhr-status');

    // --- LOGIQUE API PAYS ---
    document.getElementById('countrySelect').addEventListener('change', async (e) => {
        const country = e.target.value;
        if (!country) return;
        statusLabel.innerText = "Fetch: " + country;
        try {
            const res = await fetch(`https://restcountries.com/v3.1/name/${country}`);
            const data = await res.json();
            map.flyTo(data[0].latlng, 5);
        } catch (err) { statusLabel.innerText = "XHR Error"; }
    });

    // --- FONCTIONS CHALLENGE DYNATRACE ---

    // 1. FREEZE CPU : Bloque le navigateur (Excellent pour voir les Long Tasks)
    function triggerCPUStress() {
        statusLabel.innerText = "CPU Freeze en cours...";
        statusLabel.style.color = "#ef4444";
        const start = Date.now();
        // Boucle infinie pendant 3 secondes
        while (Date.now() - start < 3000) { } 
        statusLabel.innerText = "CPU lib√©r√© apr√®s 3s";
        statusLabel.style.color = "#10b981";
    }

    // 2. ZOMBIE XHR : Une requ√™te qui ne r√©pondra jamais (Simule une API qui "pend")
    function triggerZombieAPI() {
        statusLabel.innerText = "Appel API Zombie lanc√©...";
        // On appelle une IP inexistante pour forcer un timeout r√©seau
        fetch('https://10.255.255.1/timeout_test', { mode: 'no-cors' })
            .catch(() => { statusLabel.innerText = "XHR Timeout d√©tect√©"; });
    }

    // 3. MASSIVE PAYLOAD : Force le t√©l√©chargement d'une image 4K pour plomber le score LCP
    function triggerMassivePayload() {
        statusLabel.innerText = "T√©l√©chargement 4K en cours...";
        const img = new Image();
        // Image haute r√©solution al√©atoire (env. 5-10MB)
        img.src = "https://upload.wikimedia.org/wikipedia/commons/3/3d/LARGE_ELEVATION.jpg?random=" + Math.random();
        img.onload = () => { statusLabel.innerText = "Image lourde charg√©e"; };
    }

    // 4. CRASH JS
    function triggerJSException() {
        statusLabel.innerText = "Exception JS lanc√©e !";
        throw new Error("Dynatrace Challenge: Critical JS Thread Failure");
    }

    // 5. 404
    function trigger404() {
        fetch('/api/v1/missing_resource_' + Date.now()).then(r => {
            statusLabel.innerText = "Status: " + r.status;
        });
    }
</script>

</body>
</html>
